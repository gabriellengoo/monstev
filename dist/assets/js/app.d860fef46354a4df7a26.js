!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.xochiworld=t():e.xochiworld=t()}(self,(()=>(()=>{var e={928:(e,t,i)=>{"use strict";i.d(t,{Z:()=>o});var n=i(81),r=i.n(n),a=i(645),s=i.n(a)()(r());s.push([e.id,"*{box-sizing:border-box}.noselect{-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.userSelect{-webkit-touch-callout:text;-webkit-user-select:text;-khtml-user-select:text;-moz-user-select:text;-ms-user-select:text;user-select:text}.noPointer{pointer-events:none}.cantap{pointer-events:auto}html,body{position:absolute;top:0;margin:0;left:0;width:100%;height:100%;max-width:100%;max-height:100%;min-width:100%;min-height:100%;touch-action:none}#gui{position:absolute;top:0;left:0;pointer-events:none !important;z-index:200;height:100%;width:100%;-webkit-tap-highlight-color:rgba(0,0,0,0);display:flex;align-content:center;justify-content:center;flex-wrap:nowrap;flex-direction:column;align-items:center}",""]);const o=s},645:e=>{"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var i="",n=void 0!==t[5];return t[4]&&(i+="@supports (".concat(t[4],") {")),t[2]&&(i+="@media ".concat(t[2]," {")),n&&(i+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),i+=e(t),n&&(i+="}"),t[2]&&(i+="}"),t[4]&&(i+="}"),i})).join("")},t.i=function(e,i,n,r,a){"string"==typeof e&&(e=[[null,e,void 0]]);var s={};if(n)for(var o=0;o<this.length;o++){var c=this[o][0];null!=c&&(s[c]=!0)}for(var u=0;u<e.length;u++){var d=[].concat(e[u]);n&&s[d[0]]||(void 0!==a&&(void 0===d[5]||(d[1]="@layer".concat(d[5].length>0?" ".concat(d[5]):""," {").concat(d[1],"}")),d[5]=a),i&&(d[2]?(d[1]="@media ".concat(d[2]," {").concat(d[1],"}"),d[2]=i):d[2]=i),r&&(d[4]?(d[1]="@supports (".concat(d[4],") {").concat(d[1],"}"),d[4]=r):d[4]="".concat(r)),t.push(d))}},t}},81:e=>{"use strict";e.exports=function(e){return e[1]}},483:e=>{e.exports='<div id="gui" class="noselect"> </div>'},379:e=>{"use strict";var t=[];function i(e){for(var i=-1,n=0;n<t.length;n++)if(t[n].identifier===e){i=n;break}return i}function n(e,n){for(var a={},s=[],o=0;o<e.length;o++){var c=e[o],u=n.base?c[0]+n.base:c[0],d=a[u]||0,l="".concat(u," ").concat(d);a[u]=d+1;var p=i(l),h={css:c[1],media:c[2],sourceMap:c[3],supports:c[4],layer:c[5]};if(-1!==p)t[p].references++,t[p].updater(h);else{var m=r(h,n);n.byIndex=o,t.splice(o,0,{identifier:l,updater:m,references:1})}s.push(l)}return s}function r(e,t){var i=t.domAPI(t);i.update(e);return function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;i.update(e=t)}else i.remove()}}e.exports=function(e,r){var a=n(e=e||[],r=r||{});return function(e){e=e||[];for(var s=0;s<a.length;s++){var o=i(a[s]);t[o].references--}for(var c=n(e,r),u=0;u<a.length;u++){var d=i(a[u]);0===t[d].references&&(t[d].updater(),t.splice(d,1))}a=c}}},569:e=>{"use strict";var t={};e.exports=function(e,i){var n=function(e){if(void 0===t[e]){var i=document.querySelector(e);if(window.HTMLIFrameElement&&i instanceof window.HTMLIFrameElement)try{i=i.contentDocument.head}catch(e){i=null}t[e]=i}return t[e]}(e);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");n.appendChild(i)}},216:e=>{"use strict";e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},565:(e,t,i)=>{"use strict";e.exports=function(e){var t=i.nc;t&&e.setAttribute("nonce",t)}},795:e=>{"use strict";e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(i){!function(e,t,i){var n="";i.supports&&(n+="@supports (".concat(i.supports,") {")),i.media&&(n+="@media ".concat(i.media," {"));var r=void 0!==i.layer;r&&(n+="@layer".concat(i.layer.length>0?" ".concat(i.layer):""," {")),n+=i.css,r&&(n+="}"),i.media&&(n+="}"),i.supports&&(n+="}");var a=i.sourceMap;a&&"undefined"!=typeof btoa&&(n+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(a))))," */")),t.styleTagTransform(n,e,t.options)}(t,e,i)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},589:e=>{"use strict";e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},20:(e,t,i)=>{if("undefined"==typeof AFRAME)throw new Error("Component attempted to register before AFRAME was available.");i(160),AFRAME.registerComponent("terrain-model",{schema:{planeHeight:{type:"number",default:346},planeWidth:{type:"number",default:346},segmentsHeight:{type:"number",default:199},segmentsWidth:{type:"number",default:199},zPosition:{type:"number",default:1.5},dem:{type:"asset"},map:{type:"asset"},alphaMap:{type:"asset"},wireframe:{type:"boolean",default:!1}},init:function(){var e=this.el,t=this.data;this.heightData=null,this.terrainLoader=new THREE.TerrainLoader,this.textureLoader=new THREE.TextureLoader,this._replaceTexture=this._replaceTexture.bind(this),this._updatePositionBuffer=this._updatePositionBuffer.bind(this),this._toggleWireframe=this._toggleWireframe.bind(this);var i=t.planeWidth,n=t.planeHeight,r=t.segmentsHeight,a=t.segmentsWidth;this.geometry=new THREE.PlaneBufferGeometry(i,n,a,r),this.material=new THREE.MeshLambertMaterial,this.mesh=new THREE.Mesh(this.geometry,this.material),this.mesh.rotation.x=Math.PI/180*-90,e.setObject3D("terrain",this.mesh)},update:function(e){var t=this,i=this.data,n=i.dem,r=i.map,a=i.alphaMap,s=i.zPosition,o=i.wireframe;var c=function(e){return function(i){!("map"===e&&t.data.map!==r||"alphaMap"===e&&t.data.alphaMap!==a)?(i.anisotropy=16,t._replaceTexture(e,i),t.el.emit("textureLoaded",{type:e})):i.dispose()}};n!==e.dem&&this.terrainLoader.load(n,function(e){this.heightData=e,this._updatePositionBuffer(),this.el.emit("demLoaded",{dem:n})}.bind(this)),r!==e.map&&(r?this.textureLoader.load(r,c("map")):this._replaceTexture("map",null)),a!==e.alphaMap&&(a?(this.material.transparent=!0,this.textureLoader.load(a,c("alphaMap"))):this._replaceTexture("alphaMap",null)),s!==e.zPosition&&this.mesh.scale.set(1,1,s),o!==e.wireframe&&this._toggleWireframe()},_replaceTexture:function(e,t){var i=this.material[e];this.material[e]=t,this.material.needsUpdate=!0,i&&i.dispose()},_updatePositionBuffer:function(){if(this.heightData){for(var e=this.geometry.getAttribute("position"),t=0;t<e.count;t++){var i=this.heightData[t]/65535;e.setZ(t,i)}e.needsUpdate=!0;var n=this.mesh.getObjectByName("terrain-wireframe");if(n){n.geometry.dispose();var r=new THREE.WireframeGeometry(this.geometry);n.geometry=r}this.el.emit("positionBufferUpdated")}},_toggleWireframe:function(){var e=this.mesh.getObjectByName("terrain-wireframe");if(!e){if(!this.data.wireframe)return;var t=new THREE.WireframeGeometry(this.geometry),i=new THREE.LineBasicMaterial({color:8421504,linewidth:1}),n=new THREE.LineSegments(t,i);return n.name="terrain-wireframe",n.material.opacity=.3,n.material.transparent=!0,void this.mesh.add(n)}e.geometry.dispose(),e.material.dispose(),this.mesh.remove(e)},remove:function(){this.geometry.dispose(),this.material.map.dispose(),this.material.alphaMap.dispose(),this.material.dispose(),this.data.wireframe&&this._toggleWireframe(),this.el.removeObject3D("terrain")}})},160:()=>{THREE.TerrainLoader=function(e){this.manager=void 0!==e?e:THREE.DefaultLoadingManager},THREE.TerrainLoader.prototype={constructor:THREE.TerrainLoader,load:function(e,t,i,n){var r=this,a=new XMLHttpRequest;void 0!==t&&a.addEventListener("load",(function(i){t(new Uint16Array(i.target.response)),r.manager.itemEnd(e)}),!1),void 0!==i&&a.addEventListener("progress",(function(e){i(e)}),!1),void 0!==n&&a.addEventListener("error",(function(e){n(e)}),!1),void 0!==this.crossOrigin&&(a.crossOrigin=this.crossOrigin),a.open("GET",e,!0),a.responseType="arraybuffer",a.send(null),r.manager.itemStart(e)},setCrossOrigin:function(e){this.crossOrigin=e}}}},t={};function i(n){var r=t[n];if(void 0!==r)return r.exports;var a=t[n]={id:n,exports:{}};return e[n](a,a.exports,i),a.exports}i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},i.d=(e,t)=>{for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.nc=void 0;var n={};return(()=>{"use strict";i.r(n);var e=i(483),t=i(379),r=i.n(t),a=i(795),s=i.n(a),o=i(569),c=i.n(o),u=i(565),d=i.n(u),l=i(216),p=i.n(l),h=i(589),m=i.n(h),f=i(928),v={};v.styleTagTransform=m(),v.setAttributes=d(),v.insert=c().bind(null,"head"),v.domAPI=s(),v.insertStyleElement=p();r()(f.Z,v);f.Z&&f.Z.locals&&f.Z.locals;var g={init:function(){var e=this.el.sceneEl,t=(e.renderer,new THREE.CubeTextureLoader);t.setPath("/assets/textures/skybox/");var i=t.load(["posx.png","negx.png","posy.png","negy.png","posz.png","negz.png"]);e.object3D.background=i}},y={schema:{speed:{type:"number",default:500},minX:{type:"number",default:-10},maxX:{type:"number",default:10},minZ:{type:"number",default:-10},maxZ:{type:"number",default:10},perimeterType:{type:"string",default:"rectangle"},maxRadius:{type:"number",default:10}},init:function(){this.raycaster=new THREE.Raycaster,this.plane=new THREE.Plane(new THREE.Vector3(0,1,0),0),this.intersection=new THREE.Vector3,this.isAnimating=!1,this.onMouseDown=this.onMouseDown.bind(this),this.canvasReady=!1,this.tick=function(){!this.canvasReady&&this.el.sceneEl.canvas&&(this.canvasReady=!0,this.el.sceneEl.canvas.addEventListener("mousedown",this.onMouseDown))}},onMouseDown:function(e){var t=this;if(!this.isAnimating){e.preventDefault();var i=this.el.querySelector("a-camera");if(i){var n=i.getObject3D("camera");if(n){var r=this.el.sceneEl.canvas.getBoundingClientRect(),a=new THREE.Vector2;if(a.x=(e.clientX-r.left)/r.width*2-1,a.y=-(e.clientY-r.top)/r.height*2+1,this.raycaster.setFromCamera(a,n),this.raycaster.ray.intersectPlane(this.plane,this.intersection)){var s={x:this.intersection.x,y:this.el.getAttribute("position").y,z:this.intersection.z};if("rectangle"===this.data.perimeterType)s.x=Math.max(this.data.minX,Math.min(this.data.maxX,s.x)),s.z=Math.max(this.data.minZ,Math.min(this.data.maxZ,s.z));else if("circle"===this.data.perimeterType){var o=Math.sqrt(Math.pow(s.x,2)+Math.pow(s.z,2));if(o>this.data.maxRadius){var c=this.data.maxRadius/o;s.x*=c,s.z*=c}}var u=document.createElement("a-animation");u.setAttribute("attribute","position"),u.setAttribute("to","".concat(s.x," ").concat(s.y," ").concat(s.z)),u.setAttribute("dur",this.data.speed),u.setAttribute("easing","ease-in-out"),this.el.appendChild(u),this.isAnimating=!0,u.addEventListener("animationend",(function(){t.isAnimating=!1,t.el.removeChild(u);t.el.getAttribute("position")})),this.el.object3D.position.set(s.x,s.y,s.z)}}}}},remove:function(){var e=this.el.sceneEl.canvas;e&&e.removeEventListener("mousedown",this.onMouseDown)}};i(160),i(20);document.body.style.touchAction="none",document.body.insertAdjacentHTML("afterbegin",e);var b;b={"cube-envmap":g,"drag-move":y},Object.keys(b).forEach((function(e){AFRAME.components[e]||AFRAME.registerComponent(e,b[e])}))})(),n})()));